# VN Stock Advisor (v.0.5.0)

## ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t

### Giá»›i thiá»‡u
VN Stock Advisor lÃ  má»™t cÃ´ng cá»¥ phÃ¢n tÃ­ch cá»• phiáº¿u thÃ´ng minh sá»­ dá»¥ng há»‡ thá»‘ng Multi-AI-Agent cá»§a CrewAI. 
CÃ´ng cá»¥ cÅ©ng sá»­ dá»¥ng trÃ­ tuá»‡ nhÃ¢n táº¡o Ä‘Æ°á»£c cung cáº¥p bá»Ÿi Google Gemini.
Há»‡ thá»‘ng cung cáº¥p phÃ¢n tÃ­ch toÃ n diá»‡n vá» cá»• phiáº¿u, bao gá»“m tin tá»©c, phÃ¢n tÃ­ch cÆ¡ báº£n vÃ  phÃ¢n tÃ­ch ká»¹ thuáº­t vÃ  Ä‘Æ°a ra khuyáº¿n nghá»‹.

### LÆ°u Ã½:
Dá»± Ã¡n nÃ y cÃ³ má»¥c Ä‘Ã­ch chÃ­nh lÃ  há»c táº­p vÃ  nghiÃªn cá»©u vá» Large Language Model, Prompt Engineering vÃ  CrewAI framework. Tá»« Ä‘Ã³ Ã¡p dá»¥ng vÃ o phÃ¢n tÃ­ch chá»©ng khoÃ¡n má»™t cÃ¡ch tá»± Ä‘á»™ng.
CÃ¡c bÃ¡o cÃ¡o phÃ¢n tÃ­ch Ä‘Æ°á»£c VN Stock Advisor thu tháº­p tá»« nhá»¯ng nguá»“n trÃªn Internet vÃ  tá»•ng há»£p, phÃ¢n tÃ­ch bá»Ÿi trÃ­ tuá»‡ nhÃ¢n táº¡o.
Do Ä‘Ã³, táº¥t cáº£ cÃ¡c quan Ä‘iá»ƒm, luáº­n Ä‘iá»ƒm, khuyáº¿n nghá»‹ mua/bÃ¡n mÃ  VN Stock Advisor Ä‘Æ°a ra chá»‰ mang tÃ­nh tham kháº£o. 
VN Stock Advisor khÃ´ng chá»‹u trÃ¡ch nhiá»‡m Ä‘á»‘i vá»›i báº¥t ká»³ khoáº£n thua lá»— tá»« Ä‘áº§u tÆ° nÃ o do sá»­ dá»¥ng cÃ¡c bÃ¡o cÃ¡o phÃ¢n tÃ­ch nÃ y.

### TÃ­nh nÄƒng
Sá»­ dá»¥ng há»‡ thá»‘ng 4 AI Agents Ä‘á»ƒ thá»±c hiá»‡n nhá»¯ng cÃ´ng viá»‡c sau:
- ğŸ” Tá»± Ä‘á»™ng search google vÃ  scrape cÃ¡c trang web Ä‘á»ƒ thu tháº­p vÃ  phÃ¢n tÃ­ch tin tá»©c má»›i nháº¥t vá» cá»• phiáº¿u
- ğŸ“Š Tá»± Ä‘á»™ng gá»i API vÃ  RAG Ä‘á»ƒ láº¥y dá»¯ liá»‡u vÃ  phÃ¢n tÃ­ch cÆ¡ báº£n (P/E, P/B, ROE, EPS,...)
- ğŸ“ˆ Tá»± Ä‘á»™ng thu tháº­p dá»¯ liá»‡u giÃ¡, khá»‘i lÆ°á»£ng tá»« VCI hoáº·c TCBS, tÃ­nh toÃ¡n vÃ  phÃ¢n tÃ­ch ká»¹ thuáº­t (SMA, EMA, RSI, MACD, OBV...)
- ğŸ’¡ Tá»•ng há»£p dá»¯ liá»‡u vÃ  Ä‘á» xuáº¥t quyáº¿t Ä‘á»‹nh Ä‘áº§u tÆ° (Mua/BÃ¡n/Giá»¯)

### TÃ­nh nÄƒng nÃ¢ng cao (v0.8.0)
- ğŸ¤– **Machine Learning Analysis**: Pattern Recognition, Anomaly Detection
- ğŸ“Š **Advanced Technical Analysis**: Fibonacci, Ichimoku Cloud, Volume Profile, Divergence Detection  
- ğŸ’­ **Sentiment Analysis**: PhÃ¢n tÃ­ch tÃ¢m lÃ½ thá»‹ trÆ°á»ng tá»« tin tá»©c vÃ  social media
- âš–ï¸ **Advanced Scoring System**: Há»‡ thá»‘ng cháº¥m Ä‘iá»ƒm vÃ  tÃ­nh toÃ¡n confidence Ä‘á»™ng
- ğŸ¯ **Risk Analysis**: Comprehensive risk assessment vÃ  stress testing
- ğŸ”— **Multi-Source Data Integration**: TÃ­ch há»£p dá»¯ liá»‡u tá»« nhiá»u nguá»“n vá»›i conflict resolution
- ğŸ“¡ **Real-time Data Collection**: Thu tháº­p dá»¯ liá»‡u real-time vá»›i caching vÃ  validation

### TÃ­nh nÄƒng má»›i (v0.9.0) - Industry Stock Advisor
- ğŸ­ **Industry-Based Stock Suggestions**: Gá»£i Ã½ cá»• phiáº¿u tiá»m nÄƒng theo tá»«ng ngÃ nh cá»¥ thá»ƒ
- ğŸ“ˆ **Industry Analysis & Comparison**: PhÃ¢n tÃ­ch vÃ  so sÃ¡nh hiá»‡u suáº¥t giá»¯a cÃ¡c ngÃ nh
- ğŸ¯ **Smart Industry Scoring**: Há»‡ thá»‘ng cháº¥m Ä‘iá»ƒm thÃ´ng minh dá»±a trÃªn benchmark ngÃ nh
- ğŸ” **Top Investment Opportunities**: TÃ¬m kiáº¿m top cÆ¡ há»™i Ä‘áº§u tÆ° theo ngÃ nh
- ğŸ“Š **Comprehensive Industry Dashboard**: Giao diá»‡n Streamlit hoÃ n chá»‰nh cho phÃ¢n tÃ­ch ngÃ nh
- âš–ï¸ **Industry Benchmark Integration**: TÃ­ch há»£p benchmark P/E, P/B cho 40+ ngÃ nh

### TÃ­nh nÄƒng User Experience & API (v0.8.0)
- ğŸŒ **Streamlit Web Interface**: Giao diá»‡n web thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng
- ğŸ“± **Mobile-Responsive Design**: Tá»‘i Æ°u cho thiáº¿t bá»‹ di Ä‘á»™ng vÃ  tablet
- ğŸ”Œ **REST API**: API endpoints Ä‘áº§y Ä‘á»§ cho integration vá»›i há»‡ thá»‘ng khÃ¡c
- ğŸ‘¤ **User Authentication**: Há»‡ thá»‘ng Ä‘Äƒng nháº­p, Ä‘Äƒng kÃ½ vÃ  quáº£n lÃ½ ngÆ°á»i dÃ¹ng
- ğŸ’¼ **Portfolio Management**: Quáº£n lÃ½ danh má»¥c Ä‘áº§u tÆ° cÃ¡ nhÃ¢n
- ğŸ“ˆ **Interactive Dashboard**: Dashboard tÆ°Æ¡ng tÃ¡c vá»›i biá»ƒu Ä‘á»“ nÃ¢ng cao
- ğŸ“¤ **Export Capabilities**: Xuáº¥t bÃ¡o cÃ¡o PDF, Excel, JSON
- ğŸ¨ **Advanced Visualization**: Biá»ƒu Ä‘á»“ tÆ°Æ¡ng tÃ¡c vá»›i Plotly
- ğŸ“Š **Sector Analysis**: PhÃ¢n tÃ­ch theo ngÃ nh chi tiáº¿t
- ğŸ” **Stock Comparison**: So sÃ¡nh multiple cá»• phiáº¿u

### TÃ­nh nÄƒng Telegram Bot & Watchlist (v0.9.1)
- ğŸ¤– **Telegram Portfolio Bot**: Bot Telegram hoÃ n chá»‰nh cho quáº£n lÃ½ danh má»¥c
- ğŸ“ **Smart Watchlist**: Danh sÃ¡ch theo dÃµi cá»• phiáº¿u tiá»m nÄƒng vá»›i gá»£i Ã½ mua thÃ´ng minh
- ğŸ¯ **Auto Buy Signals**: Tá»± Ä‘á»™ng phÃ¡t hiá»‡n tÃ­n hiá»‡u mua dá»±a trÃªn giÃ¡ má»¥c tiÃªu, volume, ká»¹ thuáº­t
- ğŸ“Š **Real-time Tracking**: Theo dÃµi real-time cáº£ portfolio vÃ  watchlist
- ğŸ”„ **Auto Portfolio Transfer**: Tá»± Ä‘á»™ng chuyá»ƒn tá»« watchlist sang portfolio khi mua
- ğŸ“ˆ **Advanced Alerts**: ThÃ´ng bÃ¡o thÃ´ng minh vá»›i Ä‘á»™ tin cáº­y vÃ  phÃ¢n tÃ­ch chi tiáº¿t
- âš™ï¸ **Flexible Configuration**: Cáº¥u hÃ¬nh linh hoáº¡t cho stoploss, trailing stop, phong cÃ¡ch Ä‘áº§u tÆ°

### Webdemo
- Update sau

### CÃ i Ä‘áº·t (náº¿u muá»‘n cháº¡y local)
```bash
# CÃ i Ä‘áº·t Python >= 3.10, < 3.13
https://www.python.org/downloads/

# CÃ i Ä‘áº·t uv package manager
https://docs.astral.sh/uv/getting-started/installation/

# CÃ i Ä‘áº·t crewai
uv tool install crewai

# Tham kháº£o hÆ°á»›ng dáº«n cÃ i Ä‘áº·t crewai náº¿u gáº·p lá»—i
https://docs.crewai.com/installation

# CÃ i Ä‘áº·t cÃ¡c dependencies
crewai install
```

### Cáº¥u hÃ¬nh
Táº¡o file `.env` vá»›i cÃ¡c biáº¿n mÃ´i trÆ°á»ng sau:
CÃ³ thá»ƒ thay tháº¿ cÃ¡c MODEL báº±ng cÃ¡c model khÃ¡c cá»§a Google hoáº·c tháº­m chÃ­ tá»« OpenAi, Anthropic hay local model nhÆ° Ollama.
```
GEMINI_API_KEY=your_gemini_api_key
GEMINI_MODEL=gemini/gemini-2.0-flash-001
GEMINI_REASONING_MODEL=gemini/gemini-2.5-flash-preview-04-17
SERPER_API_KEY=your_serper_api_key
# Telegram Bot (tuá»³ chá»n náº¿u dÃ¹ng Telegram Portfolio Bot)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
# vÃ­ dá»¥: 123456789 hoáº·c -1001234567890 (group/channel)
DEFAULT_CHAT_ID=
# vÃ­ dá»¥: /Users/you/Documents/portfolio.sqlite3 (Ä‘á»ƒ trá»‘ng sáº½ dÃ¹ng máº·c Ä‘á»‹nh cáº¡nh script)
TELEGRAM_PORTFOLIO_DB=
```

## ğŸ¯ CÃ¡ch sá»­ dá»¥ng

### 1. Cháº¡y Web Interface
```bash
streamlit run streamlit_app.py
```

### 2. Cháº¡y API Server
```bash
cd api && uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### 3. Cháº¡y phÃ¢n tÃ­ch truyá»n thá»‘ng (Command Line)
```bash
# VÃ o main.py, thay biáº¿n symbol báº±ng mÃ£ cá»• phiáº¿u muá»‘n phÃ¢n tÃ­ch
# Máº·c Ä‘á»‹nh hiá»‡n Ä‘ang Ä‘á»ƒ lÃ  "HPG"

# Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ cháº¡y chÆ°Æ¡ng trÃ¬nh
crewai run
```

### 5. Telegram Portfolio Bot (local-first)
Bot Telegram quáº£n lÃ½ danh má»¥c cháº¡y trÃªn mÃ¡y Mac (local), lÆ°u SQLite, cÃ³ Ä‘áº·t lá»‹ch phÃ¢n tÃ­ch hÃ ng ngÃ y.

TÃ­nh nÄƒng:
- Bot asyncio `python-telegram-bot` v21
- LÆ°u `positions`, `transactions`, `settings` vÃ o SQLite
- Decision engine plug-point: BUY_MORE / HOLD / SELL
- Äáº·t lá»‹ch háº±ng ngÃ y báº±ng JobQueue (mÃ¡y pháº£i báº­t, process Ä‘ang cháº¡y)
- Lá»‡nh: add/sell, portfolio, pnl, analyze_now, set_schedule

CÃ i Ä‘áº·t nhanh:
```bash
pip install python-telegram-bot==21.6 aiosqlite pydantic python-dotenv
```
Táº¡o biáº¿n mÃ´i trÆ°á»ng (hoáº·c thÃªm vÃ o `.env`):
```bash
export TELEGRAM_BOT_TOKEN="<your_bot_token>"
# tuá»³ chá»n: chat id Ä‘á»ƒ bot gá»­i thÃ´ng bÃ¡o khi khá»Ÿi Ä‘á»™ng
export DEFAULT_CHAT_ID="<your_chat_id>"
# tuá»³ chá»n: Ä‘Æ°á»ng dáº«n DB
# export TELEGRAM_PORTFOLIO_DB="/absolute/path/portfolio.sqlite3"
```
Cháº¡y bot:
```bash
python telegram_portfolio_bot.py
```

CÃ¡c lá»‡nh Telegram:
- `/start` â€” Ä‘Äƒng kÃ½ user, khá»Ÿi táº¡o
- `/help` â€” hÆ°á»›ng dáº«n
- `/add <mÃ£> <sl> <giÃ¡>` â€” mua/thÃªm vá»‹ tháº¿
- `/sell <mÃ£> <sl> <giÃ¡>` â€” bÃ¡n
- `/portfolio` â€” xem danh má»¥c
- `/pnl` â€” PnL theo giÃ¡ hiá»‡n táº¡i
- `/analyze_now` â€” phÃ¢n tÃ­ch ngay vÃ  gá»£i Ã½ hÃ nh Ä‘á»™ng
- `/set_schedule <HH:MM>` â€” Ä‘áº·t giá» cháº¡y hÃ ng ngÃ y theo giá» mÃ¡y

Äiá»ƒm tÃ­ch há»£p (má»Ÿ `telegram_portfolio_bot.py`):
- `PredictionEngine.predict(symbol)` â€” gá»i mÃ´ hÃ¬nh/advisor hiá»‡n cÃ³ Ä‘á»ƒ tráº£ vá» quyáº¿t Ä‘á»‹nh
- `MarketData.get_price(symbol)` â€” láº¥y giÃ¡ hiá»‡n táº¡i (máº·c Ä‘á»‹nh thá»­ `vnstock`)

### 4. Cháº¡y Industry Stock Advisor (Gá»£i Ã½ cá»• phiáº¿u theo ngÃ nh)
```bash
# Giao diá»‡n Streamlit chÃ­nh (Ä‘Ã£ tÃ­ch há»£p Industry Stock Advisor)
streamlit run streamlit_app.py

# Giao diá»‡n riÃªng cho Industry Stock Advisor
streamlit run industry_stock_advisor_ui.py

# Demo script
python demo_industry_advisor.py
```
### YÃªu cáº§u
- Python >= 3.10, < 3.13
- crewai[tools] >= 0.117.0
- google-generativeai >= 0.8.4
- vnstock >= 3.2.4
- python-dotenv >= 1.1.0
- Google Gemini API key (Ä‘Äƒng kÃ­ free tá»« [Google AI Studio](https://aistudio.google.com/apikey))
- Serper.dev API key (Ä‘Äƒng kÃ­ free tá»« [serper.dev](https://serper.dev/api-key))

### Má»™t sá»‘ lá»—i cÃ³ thá»ƒ gáº·p
- ÄÃ´i khi agent sáº½ cháº¡y lÃ¢u hÆ¡n bÃ¬nh thÆ°á»ng do giá»›i háº¡n vá» API call má»—i phÃºt (hiá»‡n táº¡i lÃ  rpm Ä‘ang set lÃ  5)
- ÄÃ´i khi server Gemini quÃ¡ táº£i dáº«n Ä‘áº¿n agent bá»‹ lá»—i, thÆ°á»ng lÃ  vÃ o buá»•i tá»‘i. CÃ³ thá»ƒ thá»­ láº¡i vÃ o 1 thá»i Ä‘iá»ƒm khÃ¡c
- CÅ©ng do giá»›i háº¡n cá»§a API free nÃªn chá»‰ search vÃ  scrape tá»‘i Ä‘a 3 nguá»“n tin.
- Do thá»­ nghiá»‡m prompting báº±ng tiáº¿ng Viá»‡t nÃªn cÃ³ kháº£ nÄƒng Gemini váº«n chÆ°a hiá»ƒu vÃ  tuÃ¢n thá»§ 100% prompt
- 1 sá»‘ trang web sá»­ dá»¥ng nhiá»u JavaScript hoáº·c cháº·n bot nÃªn bá»‹ lá»—i khi scrape dá»¯ liá»‡u (vÃ­ dá»¥ nhÆ° vietstock.vn)

### Báº£n quyá»n
MIT License

## ğŸ‡ºğŸ‡¸ English

### Introduction
VN Stock Advisor is an intelligent stock analysis tool utilizing CrewAI's Multi-AI-Agent system.
The tool also leverages artificial intelligence provided by Google Gemini.
The system provides comprehensive stock analysis, including news, fundamental analysis, technical analysis, and recommendations.

### Note:
This project's main purpose is to study and research Large Language Models, Prompt Engineering, and the CrewAI framework, applying them to automated stock analysis.
The analysis reports are collected by VN Stock Advisor from Internet sources and synthesized, analyzed by artificial intelligence.
Therefore, all viewpoints, arguments, and buy/sell recommendations provided by VN Stock Advisor are for reference only.
VN Stock Advisor is not responsible for any investment losses resulting from the use of these analysis reports.

### Features
Uses a system of 4 AI Agents to perform the following tasks:
- ğŸ” Automatically search Google and scrape websites to collect and analyze the latest stock news
- ğŸ“Š Automatically call APIs and RAG to retrieve data and perform fundamental analysis of a stock (P/E, P/B, ROE, EPS,...)
- ğŸ“ˆ Automatically collect price, volume data from API, calculate and perform technical analysis of a stock (SMA, EMA, RSI, MACD, OBV...)
- ğŸ’¡ Synthesize data and propose investment decisions (Buy/Sell/Hold)

### Webdemo
- To be updated later

### Installation (for running locally)
```bash
# Install Python >= 3.10, < 3.13
https://www.python.org/downloads/

# Install uv package manager
https://docs.astral.sh/uv/getting-started/installation/

# Install crewai
uv tool install crewai

# Refer to crewai installation guide if you encounter errors
https://docs.crewai.com/installation

# Install dependencies
crewai install
```

### Configuration
Create a `.env` file with the following environment variables:
You can replace the MODELs with other Google models or even from OpenAi, Anthropic, xAI, Ollama...
```
GEMINI_API_KEY=your_gemini_api_key
GEMINI_MODEL=gemini/gemini-2.0-flash-001
GEMINI_REASONING_MODEL=gemini/gemini-2.5-flash-preview-04-17
SERPER_API_KEY=your_serper_api_key
FIRECRAWL_API_KEY=your_firecrawl_api_key
# Telegram Bot (optional if you use Telegram Portfolio Bot)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
# example: 123456789 or -1001234567890 (group/channel)
DEFAULT_CHAT_ID=
# example: /Users/you/Documents/portfolio.sqlite3 (leave empty to use default next to the script)
TELEGRAM_PORTFOLIO_DB=
```

### Usage
```bash
# In main.py, replace the symbol variable with the stock code you want to analyze
# Currently set to "HPG" by default

# Use the following command to run the program
crewai run
```

### Telegram Bot & Watchlist Usage

#### Khá»Ÿi Ä‘á»™ng Telegram Bot
```bash
# Cháº¡y bot Telegram vá»›i phÃ¢n tÃ­ch thá»‹ trÆ°á»ng
python telegram_portfolio_bot.py

# Hoáº·c sá»­ dá»¥ng script cÃ³ sáºµn
./run_telegram_bot_with_market_analysis.sh
```

#### CÃ¡c lá»‡nh Watchlist chÃ­nh
```bash
# ThÃªm cá»• phiáº¿u vÃ o danh sÃ¡ch theo dÃµi
/watch_add VIC 50000 Cá»• phiáº¿u tiá»m nÄƒng

# Xem danh sÃ¡ch theo dÃµi
/watch_list

# XÃ³a cá»• phiáº¿u khá»i danh sÃ¡ch
/watch_remove VIC

# XÃ³a toÃ n bá»™ danh sÃ¡ch
/watch_clear
```

#### TÃ­nh nÄƒng Watchlist
- ğŸ“ **Theo dÃµi cá»• phiáº¿u tiá»m nÄƒng**: ThÃªm cá»• phiáº¿u chÆ°a mua vÃ o danh sÃ¡ch theo dÃµi
- ğŸ¯ **Gá»£i Ã½ mua thÃ´ng minh**: Bot tá»± Ä‘á»™ng phÃ¢n tÃ­ch vÃ  gá»£i Ã½ mua khi cÃ³ tÃ­n hiá»‡u tá»‘t
- ğŸ“Š **TÃ­ch há»£p tracking**: Watchlist Ä‘Æ°á»£c phÃ¢n tÃ­ch cÃ¹ng vá»›i portfolio trong má»—i láº§n tracking
- ğŸ”„ **Tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i**: Khi mua cá»• phiáº¿u, nÃ³ tá»± Ä‘á»™ng chuyá»ƒn tá»« watchlist sang portfolio

#### CÃ¡c tÃ­n hiá»‡u mua Ä‘Æ°á»£c phÃ¡t hiá»‡n
- ğŸ¯ **Äáº¡t giÃ¡ má»¥c tiÃªu**: GiÃ¡ hiá»‡n táº¡i trong vÃ²ng 2% cá»§a giÃ¡ má»¥c tiÃªu
- ğŸ“ˆ **Volume tÄƒng máº¡nh**: Volume > 150% volume trung bÃ¬nh
- ğŸ”® **TÃ­n hiá»‡u ká»¹ thuáº­t**: Sá»­ dá»¥ng PredictionEngine Ä‘á»ƒ phÃ¢n tÃ­ch
- ğŸ“ˆ **Momentum tÃ­ch cá»±c**: TÄƒng giÃ¡ > 2% trong 2 ngÃ y gáº§n nháº¥t

Chi tiáº¿t hÆ°á»›ng dáº«n sá»­ dá»¥ng: [WATCHLIST_GUIDE.md](WATCHLIST_GUIDE.md)

### Requirements
- Python >= 3.10, < 3.13
- crewai[tools] >= 0.117.0
- google-generativeai >= 0.8.4
- vnstock >= 3.2.4
- python-dotenv >= 1.1.0
- Google Gemini API key (register free from [Google AI Studio](https://aistudio.google.com/apikey))
- Serper.dev API key (register free from [serper.dev](https://serper.dev/api-key))

### Known Issues
- Occasionally, the agent system may run longer than usual due to the API call limit per minute (currently set to 5 rpm). 
- Sometimes, the Gemini server may be overloaded, resulting in agent errors; it may be advisable to try again at a later time.
- Also, due to the limit of free API, only search and scrape maximum of 3 news sources.
- Due to Vietnamese prompting, Gemini model may not follow 100% as instructed
- Due to heavy JavaScript or bot blocking, some website scraping may lead to error (notably vietstock.vn)

### License
MIT License
